var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},ExtensionSDK=function(){function e(){}return e.init=function(t,n){console.log("SDK 版本:",this.SDKVersion);var i={code:0,msg:"ok"};return"undefined"!=t.debug&&"boolean"==typeof t.debug&&(this.debug=t.debug),1==this.debug&&console.log("初始化参数:",t),"undefined"==t.gameId?void console.log("游戏ID错误"):"undefined"==t.chanId?void console.log("渠道ID错误"):(e.gameId=t.gameId,e.chanId=t.chanId,e.userId=t.userId,this.curPlatform=new sdkinter.Platform,void n(i))},e.showRotation=function(e,t){this.curPlatform.showRotation(e,t)},e.showFixed=function(e,t){this.curPlatform.showFixed(e,t)},e.showButton=function(e,t){this.curPlatform.showButton(e,t)},e.showBanner=function(e,t){this.curPlatform.showBanner(e,t)},Object.defineProperty(e,"platform",{get:function(){return sdkinter.PlatformList},enumerable:!0,configurable:!0}),e.hide=function(e){this.curPlatform.hide(e)},e.SDKVersion="extension-sdk-0.0.1",e.debug=!0,e.logUrl="https://extension-log.egret.com",e.CDN="https://wxrecstatic.egret-labs.org",e.SER="https://minisdk.egret.com",e.time=1e4,e}();__reflect(ExtensionSDK.prototype,"ExtensionSDK"),window.ExtensionSDK=ExtensionSDK||ExtensionSDK;var sdkinter;!function(e){function t(){i.getResList("popList",function(e,t){i.openPop(e,t)})}var n=function(){function e(){}return e.platform_wx=1,e.platform_baidu=2,e.platform_no=999,e}();e.PlatformList=n,__reflect(n.prototype,"sdkinter.PlatformList"),e.Style={rotation_base:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/left_base.png",level:0},rotation_top:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/left_top.png",level:2},fixed_base:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/right_base.png",level:0},fixed_top:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/right_top.png",level:2},button_base:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/btn.png",level:0,onclick:t},pop_base:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/pop_bg.png",level:0},pop_close:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/x.png",level:2},pop_head:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/tjsw.png",level:3},pop_jump:{enable:!0,texture:ExtensionSDK.CDN+"/across/ui/btn_bg1.png",level:4}},e.TheOpenPop=t;var i=function(){function t(){this.out_width=null,this.out_height=null}return t.prototype.hide=function(e){switch(e){case"rotation":t.samellStage.visible=!1;break;case"fixed":t.fixedStage.visible=!1;break;case"button":t.buttonStage.visible=!1;break;case"all":t.samellStage.visible=!1,t.fixedStage.visible=!1,t.buttonStage.visible=!1}},t.prototype.showRotation=function(e,n){var i=e.stage;e.width?(this.out_width=e.width,this.out_height=e.height):(this.out_width=164,this.out_height=164);var a=0,o=0,s="wz";e.x&&(a=e.x),e.y&&(o=e.y),e.openid&&(s=e.openid);var r=t.samellStage;this.getRotation("extensionList",function(e,n,i,a){for(var o=i,s=0;s<e.length;s++)if("jpg"==e[s].type){var d=new egret.Bitmap;0!=s&&(d.visible=!1),t._viewStack.addChild(d),t.setByCdn(d,e[s],ExtensionSDK.chanId,n,o,o,1)}else if("mc"==e[s].type){var d=new egret.Bitmap;0!=s&&(d.visible=!1),t.setByCdn(d,e[s],ExtensionSDK.chanId,n,o,o,1)}var c=new egret.Timer(ExtensionSDK.time);c.removeEventListener(egret.TimerEvent.TIMER,t.changeIndexByTimer,t._viewStack),c.addEventListener(egret.TimerEvent.TIMER,t.changeIndexByTimer,t._viewStack),c.start(),r.addChildAt(t._viewStack,1)}),r.x=a,r.y=o,i.addChild(r),n(i)},t.prototype.showButton=function(n,i){var a=this,o=n.stage;n.width?(this.out_width=n.width,this.out_height=n.height):(this.out_width=117,this.out_height=119);var s=0,r=0;n.x&&(s=n.x),n.y&&(r=n.y);var d=t.buttonStage;new egret.Bitmap,["button_base"].map(function(n){var i=e.Style[n];if(i.enable){var o=new egret.Bitmap;i.onclick&&(o.addEventListener(egret.TouchEvent.TOUCH_TAP,i.onclick,null),o.touchEnabled=!0),d.addChildAt(o,i.level),o.x=s,o.y=r,t.setRotation(o,i.texture,a.out_width,a.out_height)}});o.addChild(d),i(o)},t.prototype.showBanner=function(e,n){var i=e.stage;e.width?(this.out_width=e.width,this.out_height=e.height):this.out_width=410;var a=0,o=0;e.x&&(a=e.x),e.y&&(o=e.y);var s=t.bannerStage,r=function(e){var r=e.data.r.bannerList,d=e.data.data.path;if(r){var c=new egret.Bitmap;t.setByCdn(c,r[0],ExtensionSDK.chanId,d,this.out_width,this.out_height,3),c.touchEnabled=!0,s.addChild(c),s.x=a,s.y=o,i.addChild(s),n(i)}};1==ExtensionSDK.chanId,window.swan.request({url:ExtensionSDK.SER+"?a=getBannerList&gameId="+ExtensionSDK.gameId.toString(),success:r})},t.prototype.showFixed=function(e,n){var i=e.stage;e.width?(this.out_width=e.width,this.out_height=e.height):(this.out_width=164,this.out_height=164);var a=0,o=0;e.x&&(a=e.x),e.y&&(o=e.y);var s=t.fixedStage;this.getRotation("fixedList",function(e,n,i,a){for(var o=i,r=0;r<e.data.length;r++){var d=new Array;if(d.type=e.data[r].game_type,d.image_path=e.data[r].game_icon.icon,e.data[r].game_icon.json1&&(d.json1=e.data[r].game_icon.json1),d.id=e.data[r].game_id,d.appid=e.data[r].game_appid,"jpg"==e.data[r].game_type){var c=new egret.Bitmap;t._fixStack.addChild(c),t.setByCdn(c,d,ExtensionSDK.chanId,n,o,o,2)}else if("mc"==e.data[r].game_type){var c=new egret.Bitmap;t.setByCdn(c,d,ExtensionSDK.chanId,n,o,o,2)}}t._fixStack.scaleX=i/90,t._fixStack.scaleY=a/90,s.addChildAt(t._fixStack,1)}),s.x=a,s.y=o,i.addChild(s),n(i)},t.prototype.getRotation=function(e,t){var n=ExtensionSDK.gameId,i=ExtensionSDK.chanId,a=ExtensionSDK.userId,o=new Array,s=null,r=this.out_width,d=this.out_height,c=function(n){"extensionList"==e?o=n.data.data.extensionList:"fixedList"==e&&(o=n.data.data.fixedList),s=n.data.data.path,t(o,s,r,d)};1==ExtensionSDK.chanId&&wx.request({url:ExtensionSDK.SER+'/Dissemination.carouselInfo?data={"gameId":'+n+',"chanId":'+i+',"userId":"'+a+'"}',success:c}),2==ExtensionSDK.chanId&&window.swan.request({url:ExtensionSDK.SER+'/Dissemination.carouselInfo?data={"gameId":'+n+',"chanId":'+i+',"userId":"'+a+'"}',success:c})},t.setRotation=function(e,t,n,i){if(t instanceof egret.Texture)return e.texture=t,e;n||(n=104);var a=t,o=new egret.ImageLoader;return o.once(egret.Event.COMPLETE,function(){var t=new egret.Texture;t.bitmapData=o.data,e.texture=t,e.width=n,e.height=i},null),o.once(egret.IOErrorEvent.IO_ERROR,function(e){console.error(e)},null),o.load(a),e},t.setByCdn=function(e,n,i,a,o,s,r){switch(n.type){case"jpg":t.setRotation(e,a+n.image_path,o,o),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.jump(n.appid,n.id,r)},this);break;case"mc":var d,c,u=function(e){c=e.data};1==ExtensionSDK.chanId&&wx.request({url:ExtensionSDK.CDN+"/"+n.json1,success:u}),2==ExtensionSDK.chanId&&window.swan.request({url:ExtensionSDK.CDN+"/"+n.json1,success:u});var l=new egret.ImageLoader;l.once(egret.Event.COMPLETE,function(){var t=new egret.Texture;t.bitmapData=l.data,d=t,d&&c&&h(e,c,d)},null),l.load(ExtensionSDK.CDN+"/"+n.image_path);var h=function(e,i,a){var d=new egret.MovieClipDataFactory(i,a);e=new egret.MovieClip(d.generateMovieClipData(i.name)),e.play(-1),e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.jump(n.appid,n.id,r)},this),e.width=o,e.height=s,e.anchorOffsetX=0,e.anchorOffsetY=0,1==r&&t._viewStack.addChild(e),2==r&&t._fixStack.addChild(e)};break;case"lg":}},t.openPop=function(n,i){var a=506,o=698,s=n.data;if(null==t.pop&&0!=n.length){var r=new egret.DisplayObjectContainer;r.x=(egret.MainContext.instance.stage.stageWidth-a)/2,r.y=(egret.MainContext.instance.stage.stageHeight-o)/2,t.pop=1;var d=a,c=(new egret.Bitmap,["pop_base","pop_close"].map(function(n){var i=e.Style[n];if(i.enable){var s=new egret.Bitmap;s.touchEnabled=!0,i.position&&(s.anchorOffsetX=i.position.x,s.y=i.position.y),"pop_close"==n&&(a=52,o=52,s.x=d-39,s.anchorOffsetY=13,s.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.buttonStage.removeChild(t.buttonStage.getChildAt(t.buttonStage.numChildren-1)),t.pop=null},null),s.touchEnabled=!0),r.addChildAt(s,i.level),t.setRotation(s,i.texture,a,o)}}),93),u=24;if(s.length>=1)for(var l,h,g,p,x,f,m=function(){var n=s[_];l=154*_,h=new egret.Bitmap,h.x=u,h.y=c+l,r.addChild(h),t.setRotation(h,e.Style.pop_head.texture,118,118),g=new egret.Bitmap,g.x=340,g.y=120+l,t.setRotation(g,e.Style.pop_jump.texture,145,59),r.addChild(g),g.touchEnabled=!0,g.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.jump(n.game_appid,n.game_id,4)},S),p=new egret.Bitmap,p.x=u,p.y=c+l,x={image_path:s[_].game_icon.icon,type:s[_].game_type,name:n.game_name,appid:s[_].game_appid,id:s[_].game_id},t.setByCdn(p,x,ExtensionSDK.chanId,i,118,118,4),r.addChild(p),f=new egret.TextField,f.text=s[_].game_name,f.size=26,f.height=170,f.y=136+l,f.x=128+u,f.textAlign=egret.HorizontalAlign.CENTER,f.textColor=10445868,r.addChild(f)},S=this,_=0;_<s.length;_++)m();var w=t.buttonStage.numChildren;t.buttonStage.addChildAt(r,w)}},t.jump=function(e,t,n){if(1==ExtensionSDK.chanId){var i=ExtensionSDK.userId,a='{"gameId":'+ExtensionSDK.gameId+',"chanId":'+ExtensionSDK.chanId+',"userId":"'+i.toString()+'","type":2,"platformP":"{}"}';wx.request({url:ExtensionSDK.SER+"/ShareVideo.getRule?data="+a,success:function(i){i.data.data.allow&&(wx.navigateToMiniProgram({appId:e,extraData:{id:ExtensionSDK.gameId,from:"wx"},success:function(e){},complete:function(e){}}),wx.request({url:ExtensionSDK.logUrl+"/stat/stat.php?data="+JSON.stringify({game_id:ExtensionSDK.gameId,channel:ExtensionSDK.chanId,extension_game_id:t,type:n,system:egret.Capabilities.os}),success:function(){}}))}})}if(2==ExtensionSDK.chanId){var o=ExtensionSDK.SER+'/ShareVideo.getRule?data={"gameId":'+ExtensionSDK.gameId+',"chanId":'+ExtensionSDK.chanId+',"userId":"'+ExtensionSDK.userId+'","type":2,"platformP":"{}"}';window.swan.request({url:o,success:function(i){i.data.data.allow&&(window.swan.navigateToMiniProgram({appKey:e,extraData:{id:ExtensionSDK.gameId,from:"baidu"},success:function(e){},complete:function(e){}}),window.swan.request({url:ExtensionSDK.logUrl+"/stat/stat.php?data="+JSON.stringify({game_id:ExtensionSDK.gameId,channel:ExtensionSDK.chanId,extension_game_id:t,type:n,system:egret.Capabilities.os}),success:function(){}}))}})}},t.drawMask=function(e,t,n,i,a,o,s){switch(e){case 1:var r=new egret.Shape;r.graphics.beginFill(16711680),r.graphics.drawCircle(i,a,t),r.graphics.endFill();break;case 2:var r=new egret.Shape;r.graphics.beginFill(65280),r.graphics.drawRoundRect(i,a,t,n,o,s),r.graphics.endFill()}return r},t.getResList=function(e,t){var n=ExtensionSDK.gameId,i=ExtensionSDK.chanId,a=ExtensionSDK.userId,o=new Array,s=null,r=function(n){(void 0==n.code||0!=n.code)&&t(o,""),"extensionList"==e?o=n.data.data.extensionList:"fixedList"==e?o=n.data.data.fixedList:"popList"==e?o=n.data.data.popList:"bannerList"==e&&(o=n.data.data.bannerList),s=n.data.data.path,t(o,s)};2==ExtensionSDK.chanId&&("popList"==e?window.swan.request({url:ExtensionSDK.SER+'/Dissemination.carouselInfo?data={"gameId":'+n+',"chanId":'+i+',"userId":"'+a+'"}',success:r}):window.swan.request({url:ExtensionSDK.SER+"?a=getBannerList&gameId="+n.toString(),success:r})),1==ExtensionSDK.chanId&&("popList"==e?wx.request({url:ExtensionSDK.SER+'/Dissemination.carouselInfo?data={"gameId":'+n+',"chanId":'+i+',"userId":"'+a+'"}',success:r}):wx.request({url:ExtensionSDK.SER+"?a=getBannerList&gameId="+n.toString(),success:r}))},t.role=new egret.MovieClip,t.samellStage=new egret.DisplayObjectContainer,t.fixedStage=new egret.DisplayObjectContainer,t.buttonStage=new egret.DisplayObjectContainer,t.bannerStage=new egret.DisplayObjectContainer,t.url=ExtensionSDK.SER+"/",t._viewStack=new egret.DisplayObjectContainer,t._fixStack=new egret.DisplayObjectContainer,t.pop=null,t.rotationNum=1,t.ratio=.634,t.x_ratio=.0975,t.y_ratio=.201,t.fixed_ratio=.743,t.fixed_x_ratio=.115,t.fixed_y_ratio=.091,t.changeIndexByTimer=function(e){t._viewStack.getChildAt(t.rotationNum).visible=!1,t.rotationNum==t._viewStack.numChildren-1?t.rotationNum=0:t.rotationNum+=1,t._viewStack.getChildAt(t.rotationNum).visible=!0},t}();e.Platform=i,__reflect(i.prototype,"sdkinter.Platform",["sdkinter.InPlatform"])}(sdkinter||(sdkinter={}));